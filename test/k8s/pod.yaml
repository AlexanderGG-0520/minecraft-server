apiVersion: v1
kind: Pod
metadata:
  name: mc-test
spec:
  restartPolicy: Never
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 1000
    fsGroup: 1000

  containers:
    - name: mc
      image: mc-server:test
      env:
        - name: EULA
          value: "true"
        - name: TYPE
          value: "${{ matrix.type }}"
        - name: VERSION
          value: "1.21.1"
        - name: MEMORY
          value: "1G"
        - name: JVM_XMS
          value: "1G"
        - name: JVM_XMX
          value: "1G"
        - name: JVM_GC
          value: "G1"

      volumeMounts:
        - name: data
          mountPath: /data
      resources:
        limits:
          memory: "2Gi"
          cpu: "1"
        requests:
          memory: "1Gi"
          cpu: "0.5"
      readinessProbe:
        exec:
          command: ["test", "-f", "/data/.ready"]
        initialDelaySeconds: 5
        periodSeconds: 5
        failureThreshold: 3

  volumes:
    - name: data
      emptyDir: {}
